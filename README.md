### Telegram Comment Collector Bot

Этот скрипт помогает собирать сообщения и комментарии из группы Telegram и сохранять их в Excel-файлы.
В формате:
| Порядковый номер |  дата | Имя | Ник | сообщение
| ----- |----| --------|--------|--------|
| 1 |  15/08/2025 | Антон | @user1 | сообщение
| 2 |  16/08/2025 | Максим | @user2 | сообщение

#### Что делает скрипт

- Собирает все сообщения из выбранной группы в Excel-файл.

- Находит конкретный пост по тексту, который вы переслали боту.

- Собирает все комментарии к этому посту.

- Сохраняет комментарии в отдельный Excel-файл для удобного просмотра и анализа.

#### Используемые технологии

Python 3.10+

Aiogram — для работы с ботом Telegram.

Telethon — для доступа к сообщениям Telegram-группы.

Pandas — для работы с Excel-файлами.

dotenv — для хранения конфиденциальных данных.

#### Установка

Скачайте скрипт
```
git clone git@github.com:AntonNovozhilov/Comment-Collector-TG.git
```
Установите зависимости:
```
pip install -r requirements.txt
```

Создайте файл .env в папке со скриптом.
```
touch .env
```

Настройка файла .env

Файл .env должен содержать ваши данные для Telegram:

BOT_TOKEN=ВАШ_ТОКЕН_БОТА

API_ID=ВАШ_API_ID

API_HASH=ВАШ_API_HASH

DISCUSSION_CHAT_ID=ВАШ_ID_ГРУППЫ_ГДЕ_ДУБЛИРУЮТСЯ_КОММЕНЕТАРИИ(-1002638861100)



BOT_TOKEN — токен вашего бота, который вы получили у BotFather.

API_ID и API_HASH — данные, получаемые на my.telegram.org.
Эти данные нужны Telethon для доступа к сообщениям группы от имени вашего аккаунта.

#### Как использовать

Запустите бота:
```
python main.py
```

Собрать все сообщения группы:

Введите команду /collect_all в чат с ботом — бот создаст Excel-файл со всеми сообщениями.

Собрать комментарии к конкретному посту:

Перешлите боту сообщение из группы, текст которого вы хотите найти.

Бот найдет сообщение и соберет все его комментарии в отдельный Excel-файл.